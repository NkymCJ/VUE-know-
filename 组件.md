拆分Vue实例的代码量，以不同组件划分不同功能。

组件化和模块化的区别：

1. 模块化：从代码逻辑的角度划分的。方便代码分层开发，保证每个功能模块的职能单一。

2. 组件化：从UI界面的角度划分的。前端的组件化，方便UI组件的重用。

## 创建全局组件

### 方式一

先使用```Vue.extend```创建Vue扩展实例构造器。

```
var com = Vue.extend({
    template: '<h3>Hello Global Component!</h3>'
});
```

补充：组件的template属性指向的模板内容必须有且只有一个根元素。

再使用```Vue.component('组件名称',Vue扩展实例构造器)```注册组件。

组件名称最好命名方式：小写或小写短横线分隔。

如果组件注册时使用的是驼峰式，使用的时候要改为小写且短横线分隔。

```
<div id="app" v-cloak>
    <my-com></my-com> <!-- 小写且短横线分割 -->
</div>

var com = Vue.extend({
    template: '<h3>Hello Global Component!</h3>'
});
Vue.component('myCom', com); // 驼峰式
var vm = new Vue({
    el: '#app'
});
```

也可以结合成一步操作。

```
Vue.component('myCom', Vue.extend({
    template: '<h3>Hello Global Component!</h3>'
}));
```

还可以直接不用Vue.extend，直接传递一个对象。

```
Vue.component('myCom', {
    template: '<h3>Hello Global Component!</h3>'
});
```

### 方式二

使用template元素，在外部定义组件的模板结构，加上id属性。

```
<template id="temp">
    <div>
        <h1>通过template元素，在外部定义的组件结构</h1>
    </div>
</template>
```

使用```Vue.component('组件名称',{template:'#template元素的id'})```注册组件。

```
Vue.component('my-com', {
    template: '#temp'
});
```

## 创建私有组件

与创建全局组件类似。

使用组件的components属性。

```
components: {
    'my-com': {
        // template: '<h3>Hello Private Component!</h3>'
        template: '#temp'
    }
}
```

## 更方便的创建写法

## 组件中的data属性

必须是一个方法。

方法内部必须返回一个对象。

使用方式与实例中的一样。

```
data: function() {
    return {}
}
```

### 为什么data属性必须是一个方法且返回一个新对象

因为对象是引用类型的。如果引用同一个对象，则会影响其他组件。

## 组件切换
    
### 方法一

使用```v-if v-else```或```v-show```实现两组件切换。

```
<input type="button" @click="flag = true" value="登录">
<input type="button" @click="flag = false" value="注册">
<login v-if="flag"></login>
<register v-else></register>

Vue.component('login', {
    template: '<h3>登录组件</h3>'
});
Vue.component('register', {
    template: '<h3>注册组件</h3>'
});
var vm = new Vue({
    el: '#app',
    data: {
        flag: true
    }
});
```

### 方法二

使用```component元素```实现多组件切换。

component是一个占位符，:is属性可以用来指定要展示的组件的名称

```
<input type="button" @click="component = 'login'" value="登录">
<input type="button" @click="component = 'register'" value="注册">
<component :is="component"></component>

Vue.component('login', {
    template: '<h3>登录组件</h3>'
});
Vue.component('register', {
    template: '<h3>注册组件</h3>'
});
var vm = new Vue({
    el: "#app",
    data: {
        component: "login"
    }
});
```

## 组件切换动画

我们只需要使用transition把component包起来即可，且不需要使用key特性。

```
.v-enter,
.v-leave-to {
    opacity: 0;
    transform: translateX(180px);
}
.v-enter-active,
.v-leave-active {
    transition: all 0.5s ease;
}

<div id="app" v-cloak>
    <input type="button" @click="component = 'login'" value="登录">
    <input type="button" @click="component = 'register'" value="注册">

    <transition mode="out-in">
        <component :is="component"></component>
    </transition>
</div>

Vue.component('login', {
    template: '<h3>登录组件</h3>'
});
Vue.component('register', {
    template: '<h3>注册组件</h3>'
});
var vm = new Vue({
    el: '#app',
    data: {
        component: 'login'
    }
});
```

## 组件间传值

- 父组件向子组件传值

    + 在引用子组件的时候，通过 **属性绑定(v-bind:)** 形式，把需要传递给子组件的数据，以属性绑定的形式，传递到子组件内部，供子组件使用

    + 需要在子组件的 **props** 属性中定义一下，才能使用

        *props 中的数据都是通过父组件传递给子组件的，只读，无法重新赋值*
    
    + 示例

        ```
        <!-- HTML -->
        <div id="app">
            <com1 v-bind:parentmsg="msg"></com1>
        </div>

        <!-- SCRIPT -->
        var vm = new Vue({
            el: '#app',
            data: function () {
                return {
                    msg: '父组件中的数据'
                }
            },
            components: {
                com1: {
                    props: ['parentmsg'],
                    template: '<h1>这是子组件{{parentmsg}}</h1>'
                },
                methods: {
                }
            }
        });
        ```

- 父组件传递方法给子组件

    + 在引用子组件的时候，通过 **事件监听(v-on:)** 形式，把需要传递给子组件的方法，以事件监听的形式，传递到子组件内部，供子组件使用

    + 子组件中的方法通过 **this.$emit('事件监听绑定的方法名')** 去执行绑定在此名上的父组件的方法

        *this.$emit的第一个参数为事件监听方法名，其余参数为父组件方法的参数*
    
    + 示例

        ```
        <!-- HTML -->
        <div id="app">
            <!-- 把父组件的 show 方法放在子组件的func上，供emit使用 -->
            <com1 @func="show"></com1>
        </div>
        <template id="tmp1">
            <div>
                <h1>这是子组件</h1>
                <input type="button" value="子组件的按钮，点击触发父组件传递的func方法" @click="myClick">
            </div>
        </template>

        <!-- SCRIPT -->
        var com1 = {
            template: '#tmp1',
            data () {
                return {
                    info:{
                        name:'cj',
                        age:23
                    }      
                }
            },
            methods: {
                myClick() {
                    // 第一个参数为函数名，其余参数为函数参数
                    this.$emit('func',this.info);
                }
            }
        }
        var vm = new Vue({
            el: '#app',
            data: function () {
                return {
                    info:null
                }
            },
            components: {
                //com1:com1
                com1
            },
            methods: {
                show(data) {
                    // console.log('调用了父组件身上的show方法');
                    this.info = data;
                }
            }
        });
        ```

- refs获取DOM元素和组件

    + 示例

        ```
        <!-- HTML -->
        <div id="app">
            <input type="button" value="获取元素" @click="getElement">
            <hr>
            <!-- <h3 id="myH3" ref="myH3">Hello World</h3> -->
            <login ref="muLogin"></login>
        </div>

        <!-- SCRIPT -->
        var login = {
            template: '<h3>组件</h3>',
            data() {
                return {
                    msg: '123'
                }
            },
            methods: {
                show() {
                    console.log('123');
                }
            }
        };
        var vm = new Vue({
            el: '#app',
            data: function () {
                return {

                }
            },
            methods: {
                getElement() {
                    // console.log(document.getElementById('myH3').innerText);
                    // console.log(this.$refs.myH3.innerText);
                    // console.log(this.$refs.muLogin);
                    // console.log(this.$refs.muLogin.msg);
                    console.log(this.$refs.muLogin.show());
                }
            },
            components: {
                login
            }
        });
        ```
